<!DOCTYPE html><!--[if lt IE 7]>      <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="description" content="Personal Blogging Site of Shichao An">
        <meta name="viewport" content="width=device-width">
        <title>Page 2 &mdash; Shichao&#39;s Blog</title>
            <link rel="stylesheet" href="_static/normalize.css" type="text/css">
            <link rel="stylesheet" href="_static/sphinx.css" type="text/css">
            <link rel="stylesheet" href="_static/main.css" type="text/css">
            <link rel="stylesheet" href="_static/flat.css" type="text/css">
            <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
            <link rel="stylesheet" href="_static/font-awesome.min.css" type="text/css">
        <link rel="stylesheet" href="_static/style.css" type="text/css" /><link rel="shortcut icon" href="_static/favicon.ico" /><!-- Load modernizr and JQuery -->
        <script src="_static/vendor/modernizr-2.6.2.min.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="_static/vendor/jquery-1.8.2.min.js"><\/script>')</script>
        <script src="_static/plugins.js"></script>
        <script src="_static/main.js"></script>
        
  <link rel="prev" title="Newer" href="index.html" /><link rel="alternate" type="application/rss+xml" title="RSS" href="rss.html" />
  <link rel="canonical" href="http://blog.shichao-an.info/blog/html/page2.html" /><script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.4.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script><script type="text/javascript" src="_static/underscore.js"></script><script type="text/javascript" src="_static/doctools.js"></script><script type="text/javascript" src="_static/disqus.js"></script><script type="text/javascript" src="_static/google_analytics.js"></script>


    <script type="text/javascript">
        $(document).ready(function () {
            // Scroll to content if on small screen
            if (screen.width < 480)
            {
                $(document).scrollTop(document.getElementsByTagName("article")[0].offsetTop - 44);
            }
        });
    </script>
</head>
    <body role="document">
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

      <div id="container"><header role="banner">
            <hgroup>
              <h1><a href="index.html">Shichao&#39;s Blog</a></h1><h2>Recording molecular stuff</h2></hgroup>
          </header>
      <nav role="navigation">
            <ul><li class="main-nav">
                  <a href="index.html">Home</a>
                </li>
              <li class="main-nav">
                  <a href="pages/about.html">About</a>
                </li>
              </ul>
          </nav><div class="main-container" role="main"><div class="main wrapper clearfix"><article><div class="timestamp postmeta">
            <span>November 05, 2013</span>
        </div>
        <h1><a href="2013/11/05/apache_name_based_virtual_hosts.html">Apache name-based virtual hosts and reverse DNS</a></h1>
<p>On some operating systems such as Ubuntu, you can setup virtual hosts quite easily with the default Apache server (installed with APT). The global configuration file /etc/apache2/apache2.conf contains the following line as the last line by default:</p>
<div class="highlight-apache"><div class="highlight"><pre><span class="nb">Include</span> sites-enabled/
</pre></div>
</div>
<p>This means all virtual hosts configurations are loaded from the /etc/apache2/sites-enabled directory in alphabetical order. If you list this directory, you will find there is already a symbolic link 000-default that points to /etc/apache2/sites-available/default. This default virtual host configuration file does not contain a <span class="docutils literal"><span class="pre">ServerName</span></span> directive, and neither does the global configuration file (/etc/apache2/apache2.conf) by default. The default port.conf contains the following line:</p>
<div class="highlight-apache"><div class="highlight"><pre><span class="nb">NameVirtualHost</span> *:80
</pre></div>
</div>
<p>This means all the following name-virtual hosts will follow this <span class="docutils literal"><span class="pre">NameVirtualHost</span></span> directive, which receives requests on all interfaces on the server. <sup>[1]</sup></p>
<p>Basically, you can place your own virtual host configuration file in /etc/apache2/sites-available directory and use the a2ensite command to enable this configuration (by creating a symbolic link at /etc/apache2/sites-enabled that Apache will load). If you owns a domain example.com and a subdomain wiki.example.com that both points to the IP address of this server, you can create a virtual host with <span class="docutils literal"><span class="pre">ServerName</span> <span class="pre">wiki.example.com</span></span> (the argument to <span class="docutils literal"><span class="pre">&lt;VirtualHost&gt;</span></span> is <a href="#id1"><span class="problematic" id="id2">*</span></a>:80 in this case). If the configuration filename is wiki, you can use a2ensite wiki command to enable it.</p>
<p>Given these, let’s see how Apache handles requests for virtual hosts. When a request arrives, the server will find the best (most specific) matching <span class="docutils literal"><span class="pre">&lt;VirtualHost&gt;</span></span> argument based on the IP address and port used by the request. If there is more than one virtual host containing this best-match address and port combination, Apache will further compare the <span class="docutils literal"><span class="pre">ServerName</span></span> and <span class="docutils literal"><span class="pre">ServerAlias</span></span> directives to the server name present in the request. <sup>[2]</sup></p>
<p>If you try to visit wiki.example.com you actually request the IP of this server. The Apache server will handle this request by comparing active virtual host configurations. It first checks 000-default, but detects no <span class="docutils literal"><span class="pre">ServerName</span></span> directive (neither does the global configuration as mentioned before). As a result, it performs a reverse DNS lookup to find the <span class="docutils literal"><span class="pre">ServerName</span></span>. <sup>[3]</sup> If you have not setup a reverse DNS for this IP to wiki.example.com, the match will fail and Apache continues to match the next virtual host, wiki, which does have a <span class="docutils literal"><span class="pre">ServerName</span></span>, wiki.example.com, and this is a match. Apache will respond with this virtual host.</p>
<p>However, if you have recently setup a reverse DNS for IP of your server to wiki.example.com, a different result will come out. When you access wiki.example.com, Apache first checks 000-default, and performs a reverse DNS resolution only to find wiki.example.com as the result for <span class="docutils literal"><span class="pre">ServerName</span></span>, and this is a match. Apache will respond with 000-default instead of wiki and you will browse Web page for 000-default rather than wiki. To solve this problem, you can either set a global <span class="docutils literal"><span class="pre">ServerName</span></span> with example.com at /etc/apache2/apache2.conf or specify a <span class="docutils literal"><span class="pre">ServerName</span></span> for 000-default. In this way, the Apache will match the right <span class="docutils literal"><span class="pre">ServerName</span></span> with your request even if you setup a reverse DNS for one of the virtual hosts.</p>
<div class="section" id="reference">
<h2>Reference</h2>
<ol class="arabic simple">
<li><a class="reference external" href="http://httpd.apache.org/docs/2.2/mod/core.html#namevirtualhost">http://httpd.apache.org/docs/2.2/mod/core.html#namevirtualhost</a></li>
<li><a class="reference external" href="http://httpd.apache.org/docs/current/vhosts/name-based.html">http://httpd.apache.org/docs/current/vhosts/name-based.html</a></li>
<li><a class="reference external" href="http://httpd.apache.org/docs/current/dns-caveats.html">http://httpd.apache.org/docs/current/dns-caveats.html</a></li>
</ol>
</div>

        <div class="postmeta">
        <div class="author">
            <span>Posted by Shichao An</span>
        </div>
        
        <div class="tags">
            <span>
                Tags:
                <a href="tags/apache.html">Apache</a>, <a href="tags/network.html">Network</a>, <a href="tags/dns.html">DNS</a></span>
        </div>
        <div class="comments">
            <a href="http://blog.shichao-an.info/blog/html/2013/11/05/apache_name_based_virtual_hosts.html#disqus_thread" data-disqus-identifier="2013/11/05/apache_name_based_virtual_hosts">Leave a comment</a>
        </div></div><div class="separator post_separator"></div><div class="timestamp postmeta">
            <span>October 25, 2013</span>
        </div>
        <h1><a href="2013/10/25/amazon_ec2_auto_scaling_example.html">Amazon EC2 Auto Scaling example</a></h1>
<p>The following code creates an Auto Scaling group with scale-up and scale-down policies based on the monitoring the CPU utilization of either a specific EC2 instance or instances within the Auto Scaling group cluster.</p>
<p>If <span class="docutils literal"><span class="pre">alarm_dimensions</span></span> specifies <span class="docutils literal"><span class="pre">InstanceId</span></span>, the Auto Scaling group will scale up or down according to the CPU utilization of the specified running instance; if <span class="docutils literal"><span class="pre">alarm_dimensions</span></span> specifies <span class="docutils literal"><span class="pre">AutoScalingGroupName</span></span>, the Auto Scaling group will scale up or down according to the CPU utilization of instances within its existing cluster. For more metrics and dimensions in CloudWatch, see <a class="reference external" href="http://docs.aws.amazon.com/AmazonCloudWatch/latest/DeveloperGuide/ec2-metricscollected.html">Amazon Elastic Compute Cloud Dimensions and Metrics</a>.</p>
<p>Raw code can be <a class="reference external" href="https://raw.githubusercontent.com/moleculea/autoscale_sample/master/autoscale_sample.py">downloaded here</a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">boto.ec2</span>
<span class="kn">from</span> <span class="nn">boto.ec2.autoscale</span> <span class="kn">import</span> <span class="p">(</span><span class="n">AutoScalingGroup</span><span class="p">,</span>
                                <span class="n">LaunchConfiguration</span><span class="p">,</span> <span class="n">ScalingPolicy</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">boto.ec2.cloudwatch</span> <span class="kn">import</span> <span class="n">MetricAlarm</span>


<span class="c"># Create connections to Auto Scaling and CloudWatch</span>
<span class="n">as_conn</span> <span class="o">=</span> <span class="n">boto</span><span class="o">.</span><span class="n">ec2</span><span class="o">.</span><span class="n">autoscale</span><span class="o">.</span><span class="n">connect_to_region</span><span class="p">(</span><span class="s">"us-east-1"</span><span class="p">)</span>
<span class="n">cw_conn</span> <span class="o">=</span> <span class="n">boto</span><span class="o">.</span><span class="n">ec2</span><span class="o">.</span><span class="n">cloudwatch</span><span class="o">.</span><span class="n">connect_to_region</span><span class="p">(</span><span class="s">"us-east-1"</span><span class="p">)</span>

<span class="c"># Name for auto scaling group and launch configuration</span>
<span class="n">as_name</span> <span class="o">=</span> <span class="s">"VM1"</span>

<span class="c"># Create launch configuration</span>
<span class="n">lc</span> <span class="o">=</span> <span class="n">LaunchConfiguration</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">as_name</span><span class="p">,</span>
                         <span class="n">image_id</span><span class="o">=</span><span class="s">"ami-76f0061f"</span><span class="p">,</span>  <span class="c"># AMI ID of your instance</span>
                         <span class="n">key_name</span><span class="o">=</span><span class="s">"your_key_name"</span><span class="p">,</span>
                         <span class="n">security_groups</span><span class="o">=</span><span class="s">"your_group_name"</span><span class="p">,</span>
                         <span class="n">instance_type</span><span class="o">=</span><span class="s">"t1.micro"</span><span class="p">,</span>
                         <span class="n">instance_monitoring</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">as_conn</span><span class="o">.</span><span class="n">create_launch_configuration</span><span class="p">(</span><span class="n">lc</span><span class="p">)</span>

<span class="c"># Create Auto Scaling group</span>
<span class="n">ag</span> <span class="o">=</span> <span class="n">AutoScalingGroup</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="n">as_name</span><span class="p">,</span>
                      <span class="n">availability_zones</span><span class="o">=</span><span class="p">[</span><span class="s">"us-east-1b"</span><span class="p">],</span>
                      <span class="n">launch_config</span><span class="o">=</span><span class="n">lc</span><span class="p">,</span> <span class="n">min_size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                      <span class="n">max_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                      <span class="n">connection</span><span class="o">=</span><span class="n">as_conn</span><span class="p">)</span>

<span class="n">as_conn</span><span class="o">.</span><span class="n">create_auto_scaling_group</span><span class="p">(</span><span class="n">ag</span><span class="p">)</span>

<span class="c"># Create scaling policies</span>
<span class="n">scale_up_policy</span> <span class="o">=</span> <span class="n">ScalingPolicy</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">'scale_up'</span><span class="p">,</span> <span class="n">adjustment_type</span><span class="o">=</span><span class="s">'ChangeInCapacity'</span><span class="p">,</span>
    <span class="n">as_name</span><span class="o">=</span><span class="n">as_name</span><span class="p">,</span> <span class="n">scaling_adjustment</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cooldown</span><span class="o">=</span><span class="mi">180</span><span class="p">)</span>

<span class="n">scale_down_policy</span> <span class="o">=</span> <span class="n">ScalingPolicy</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">'scale_down'</span><span class="p">,</span> <span class="n">adjustment_type</span><span class="o">=</span><span class="s">'ChangeInCapacity'</span><span class="p">,</span>
    <span class="n">as_name</span><span class="o">=</span><span class="n">as_name</span><span class="p">,</span> <span class="n">scaling_adjustment</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">cooldown</span><span class="o">=</span><span class="mi">180</span><span class="p">)</span>

<span class="n">as_conn</span><span class="o">.</span><span class="n">create_scaling_policy</span><span class="p">(</span><span class="n">scale_up_policy</span><span class="p">)</span>
<span class="n">as_conn</span><span class="o">.</span><span class="n">create_scaling_policy</span><span class="p">(</span><span class="n">scale_down_policy</span><span class="p">)</span>

<span class="n">scale_up_policy</span> <span class="o">=</span> <span class="n">as_conn</span><span class="o">.</span><span class="n">get_all_policies</span><span class="p">(</span>
    <span class="n">as_group</span><span class="o">=</span><span class="n">as_name</span><span class="p">,</span> <span class="n">policy_names</span><span class="o">=</span><span class="p">[</span><span class="s">'scale_up'</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">scale_down_policy</span> <span class="o">=</span> <span class="n">as_conn</span><span class="o">.</span><span class="n">get_all_policies</span><span class="p">(</span>
    <span class="n">as_group</span><span class="o">=</span><span class="n">as_name</span><span class="p">,</span> <span class="n">policy_names</span><span class="o">=</span><span class="p">[</span><span class="s">'scale_down'</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

<span class="c"># Set dimensions for CloudWatch alarms</span>
<span class="c"># Monitor on a specific instance</span>
<span class="n">alarm_dimensions</span> <span class="o">=</span> <span class="p">{</span><span class="s">"InstanceId"</span><span class="p">:</span> <span class="s">"your_instance_id"</span><span class="p">}</span>

<span class="c"># Monitor instances within the Auto Scaling group cluster</span>
<span class="n">alarm_dimensions_as</span> <span class="o">=</span> <span class="p">{</span><span class="s">"AutoScalingGroupName"</span><span class="p">:</span> <span class="n">as_name</span><span class="p">}</span>

<span class="c"># Create metric alarms</span>
<span class="n">scale_up_alarm</span> <span class="o">=</span> <span class="n">MetricAlarm</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">'scale_up_on_cpu_'</span> <span class="o">+</span> <span class="n">as_name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="s">'AWS/EC2'</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="s">'CPUUtilization'</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s">'Average'</span><span class="p">,</span>
    <span class="n">comparison</span><span class="o">=</span><span class="s">'&gt;'</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="s">"80"</span><span class="p">,</span>
    <span class="n">period</span><span class="o">=</span><span class="s">'60'</span><span class="p">,</span> <span class="n">evaluation_periods</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">alarm_actions</span><span class="o">=</span><span class="p">[</span><span class="n">scale_up_policy</span><span class="o">.</span><span class="n">policy_arn</span><span class="p">],</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="n">alarm_dimensions</span><span class="p">)</span>

<span class="n">scale_down_alarm</span> <span class="o">=</span> <span class="n">MetricAlarm</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">'scale_down_on_cpu_'</span> <span class="o">+</span> <span class="n">as_name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="s">'AWS/EC2'</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="s">'CPUUtilization'</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s">'Average'</span><span class="p">,</span>
    <span class="n">comparison</span><span class="o">=</span><span class="s">'&lt;'</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="s">"20"</span><span class="p">,</span>
    <span class="n">period</span><span class="o">=</span><span class="s">'60'</span><span class="p">,</span> <span class="n">evaluation_periods</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">alarm_actions</span><span class="o">=</span><span class="p">[</span><span class="n">scale_down_policy</span><span class="o">.</span><span class="n">policy_arn</span><span class="p">],</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="n">alarm_dimensions</span><span class="p">)</span>

<span class="c"># Create alarms in CloudWatch</span>
<span class="n">cw_conn</span><span class="o">.</span><span class="n">create_alarm</span><span class="p">(</span><span class="n">scale_up_alarm</span><span class="p">)</span>
<span class="n">cw_conn</span><span class="o">.</span><span class="n">create_alarm</span><span class="p">(</span><span class="n">scale_down_alarm</span><span class="p">)</span>
</pre></div>
</div>

        <div class="postmeta">
        <div class="author">
            <span>Posted by Shichao An</span>
        </div>
        
        <div class="tags">
            <span>
                Tags:
                <a href="tags/python.html">Python</a>, <a href="tags/aws.html">AWS</a></span>
        </div>
        <div class="comments">
            <a href="http://blog.shichao-an.info/blog/html/2013/10/25/amazon_ec2_auto_scaling_example.html#disqus_thread" data-disqus-identifier="2013/10/25/amazon_ec2_auto_scaling_example">Leave a comment</a>
        </div></div><div class="separator post_separator"></div><div class="timestamp postmeta">
            <span>September 17, 2013</span>
        </div>
        <h1><a href="2013/09/17/sync_backup_files_over_lan_ssh_osx.html">Sync and backup files from a host on the LAN over SSH on Mac OS X</a></h1>
<p>Suppose you have several computers on an LAN, where DHCP is enabled. On Machine B, you want to routinely back up files from Machine A, whose IP address may change. This can be done using SSH and a local DNS server. The following experiment is done on two Mac OS X 10.8 machines.</p>
<ol class="arabic">
<li><p class="first">Set up DNS server (optional):</p>
<p><em>named</em> and <em>rndc</em> utility are installed by default on Mac OS X 10.8. For references on setup, see <a class="reference external" href="http://www.macshadows.com/kb/index.php?title=How_To:_Enable_BIND_-_Mac_OS_X">this link</a>.</p>
<ol class="arabic">
<li><p class="first">Use <span class="docutils literal"><span class="pre">rndc-confgen</span></span> to generate configuration and secret key:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo bash -c "rndc-confgen -b 256 &gt; /etc/rndc.conf"</span>
<span class="go">$ sudo bash -c " head -n5 /etc/rndc.conf | tail -n4 &gt; /etc/rndc.key"</span>
</pre></div>
</div>
</li>
<li><p class="first">Edit /etc/named.conf and /etc/rndc.conf to ensure the port number are the same</p>
</li>
<li><p class="first">Start named server, run “rndc status” to check whether it is started:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ launchctl load -w /System/Library/LaunchDaemons/org.isc.named.plist</span>
<span class="go">$ launchctl start org.isc.named</span>
<span class="go">$ rndc status</span>
</pre></div>
</div>
</li>
<li><p class="first">Create a zone file for the target machine (Machine A in this case):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ cd ~/Documents/</span>
<span class="go">$ mkdir named</span>
<span class="go">$ cd named</span>
<span class="go">$ vi machine-a.zone</span>
</pre></div>
</div>
<p>Copy the following text in to machine-a.zone, the IP address 192.168.0.120 is irrelevant at this time:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$TTL 86400</span>
<span class="go">$ORIGIN machine-a.</span>

<span class="go">@       IN      SOA     @ root (</span>
<span class="go">                        2013091701      ; serial number YYMMDDNN</span>
<span class="go">                        28800           ; Refresh</span>
<span class="go">                        7200            ; Retry</span>
<span class="go">                        864000          ; Expire</span>
<span class="go">                        86400           ; Min TTL</span>
<span class="go">            )</span>
<span class="go">        IN      NS      @</span>
<span class="go">        IN      A       192.168.0.120   ; lan-sync</span>
</pre></div>
</div>
</li>
<li><p class="first">Create symbolic link at /var/named/machine-a.zone (/private/var/named/machine-a.zone):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ ln -s /Users/yourname/Documents/named/machine-a.zone /private/var/named/machine-a.zone</span>
</pre></div>
</div>
</li>
<li><p class="first">Edit /etc/named.conf, insert the following lines after the existing zone configurations:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">zone "machine-a" IN {</span>
<span class="go">        type master;</span>
<span class="go">        file "machine-a.zone";</span>
<span class="go">        allow-update { none; };</span>
<span class="go">};</span>
</pre></div>
</div>
</li>
<li><p class="first">Edit /etc/resolv.conf, replace existing nameserver with 127.0.0.1. This file should look like this:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">#</span>
<span class="go"># This file is automatically generated.</span>
<span class="go">#</span>
<span class="go">nameserver 127.0.0.1</span>
</pre></div>
</div>
</li>
</ol>
</li>
<li><p class="first">Download the script and set the following variables in ssh_sync.sh:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ git clone https://github.com/moleculea/lan-sync-over-ssh</span>
<span class="go">$ cd lan-sync-over-ssh</span>
<span class="go">$ vi ssh_sync.sh</span>

<span class="go">user_home="/Users/yourname"</span>
<span class="go"># Remote hostname (LAN) and MAC address</span>
<span class="go">hostname="machine-a"</span>
<span class="go"># User name on the remote host</span>
<span class="go">username="yourname"</span>
<span class="go">mac_address="11:11:11:11:11:11"</span>
</pre></div>
</div>
</li>
</ol>
<p class="readmorewrapper"><a class="readmore" href="2013/09/17/sync_backup_files_over_lan_ssh_osx.html#more">Read more...</a></p> 
 
 

        <div class="postmeta">
        <div class="author">
            <span>Posted by Shichao An</span>
        </div>
        
        <div class="tags">
            <span>
                Tags:
                <a href="tags/bash.html">Bash</a>, <a href="tags/dns.html">DNS</a>, <a href="tags/os_x.html">OS X</a></span>
        </div>
        <div class="comments">
            <a href="http://blog.shichao-an.info/blog/html/2013/09/17/sync_backup_files_over_lan_ssh_osx.html#disqus_thread" data-disqus-identifier="2013/09/17/sync_backup_files_over_lan_ssh_osx">Leave a comment</a>
        </div></div><div class="separator post_separator"></div><div class="timestamp postmeta">
            <span>September 15, 2013</span>
        </div>
        <h1><a href="2013/09/15/fetch_convert_online_flash_videos.html">Fetch and convert online flash videos</a></h1>
<ol class="arabic">
<li><p class="first">Installation of prerequisite utilities:</p>
<ul class="simple">
<li>Perl module: WWW::Mechanize</li>
<li><a class="reference external" href="https://code.google.com/p/get-flash-videos/wiki/Installation">get-flash-videos</a></li>
<li><a class="reference external" href="http://www.ffmpeg.org/download.html">ffmpeg</a></li>
</ul>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo cpan install WWW::Mechanize</span>
<span class="go">$ git clone https://github.com/monsieurvideo/get-flash-videos.git /path/to/get-flash-videos</span>
<span class="go">$ ln -s /usr/local/bin/get_flash_videos /path/to/get-flash-videos/get_flash_videos</span>
</pre></div>
</div>
<p>For the installation of ffmpeg, see <a class="reference external" href="http://www.ffmpeg.org/download.html">http://www.ffmpeg.org/download.html</a>.</p>
</li>
<li><p class="first">Download flash-video-archiver scripts:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ git clone https://github.com/moleculea/flash-video-archiver.git flash-video-archiver</span>
</pre></div>
</div>
</li>
<li><p class="first">Create a file of video link list, e.g. videos.txt:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ cat /path/to/videos.txt</span>

<span class="go">http://example.com/video/4438</span>
<span class="go">http://example.com/video/4512</span>
<span class="go">http://example.org/video/hjkl</span>
</pre></div>
</div>
</li>
<li><p class="first">Fetch videos and convert them into MP4:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ cd flash-video-archiver</span>
<span class="go">$ ./fetch.sh /path/to/videos.txt /path/to/output/directory</span>
<span class="go">$ ./convert.sh /path/to/output/directory</span>
</pre></div>
</div>
</li>
</ol>

        <div class="postmeta">
        <div class="author">
            <span>Posted by Shichao An</span>
        </div>
        
        <div class="tags">
            <span>
                Tags:
                <a href="tags/bash.html">Bash</a>, <a href="tags/perl.html">Perl</a></span>
        </div>
        <div class="comments">
            <a href="http://blog.shichao-an.info/blog/html/2013/09/15/fetch_convert_online_flash_videos.html#disqus_thread" data-disqus-identifier="2013/09/15/fetch_convert_online_flash_videos">Leave a comment</a>
        </div></div><div class="separator post_separator"></div><div class="timestamp postmeta">
            <span>August 09, 2013</span>
        </div>
        <h1><a href="2013/08/09/setup_selenium_python_environment_x_ubuntu.html">Set up Selenium Python environment with X virtual framebuffer on Ubuntu server</a></h1>
<ol class="arabic">
<li><p class="first">Install relevant APT packages:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo apt-get install xorg</span>
<span class="go">$ sudo apt-get install xfvd</span>
<span class="go">$ sudo apt-get install firefox</span>
<span class="go">$ sudo apt-get install openjdk-7-jre</span>
<span class="go">$ sudo apt-get install python-pip</span>
</pre></div>
</div>
</li>
<li><p class="first">Download Selenium server and Python bindings:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo pip install selenium</span>
<span class="go">$ wget https://selenium.googlecode.com/files/selenium-server-standalone-2.34.0.jar</span>
</pre></div>
</div>
</li>
<li><p class="first">Start virtual framebuffer X server for server number 1 (for DISPLAY) in the background:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo Xvfb :1 &amp;</span>
<span class="go">$ sudo Xvfb :1 -screen 0 1280x1024x8</span>
</pre></div>
</div>
</li>
<li><p class="first">Start Selenium server in the background (without sudo):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ java -jar selenium-server-standalone-2.34.0.jar &amp;</span>
</pre></div>
</div>
</li>
<li><p class="first">Write sample Python code in sample.py:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.keys</span> <span class="kn">import</span> <span class="n">Keys</span>


<span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Firefox</span><span class="p">()</span>
<span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"http://www.python.org"</span><span class="p">)</span>
<span class="k">assert</span> <span class="s">"Python"</span> <span class="ow">in</span> <span class="n">driver</span><span class="o">.</span><span class="n">title</span>
<span class="n">elem</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s">"q"</span><span class="p">)</span>
<span class="n">elem</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s">"selenium"</span><span class="p">)</span>
<span class="n">elem</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">RETURN</span><span class="p">)</span>
<span class="k">assert</span> <span class="s">"Google"</span> <span class="ow">in</span> <span class="n">driver</span><span class="o">.</span><span class="n">title</span>
<span class="n">driver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first">Run sample.py with environment variable DISPLAY=:1:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ DISPLAY=:1 python sample.py</span>
</pre></div>
</div>
</li>
</ol>

        <div class="postmeta">
        <div class="author">
            <span>Posted by Shichao An</span>
        </div>
        
        <div class="tags">
            <span>
                Tags:
                <a href="tags/bash.html">Bash</a>, <a href="tags/python.html">Python</a>, <a href="tags/ubuntu.html">Ubuntu</a></span>
        </div>
        <div class="comments">
            <a href="http://blog.shichao-an.info/blog/html/2013/08/09/setup_selenium_python_environment_x_ubuntu.html#disqus_thread" data-disqus-identifier="2013/08/09/setup_selenium_python_environment_x_ubuntu">Leave a comment</a>
        </div></div><div class="separator post_separator"></div><div class="timestamp postmeta">
            <span>August 05, 2013</span>
        </div>
        <h1><a href="2013/08/05/make_slideshow_gif_using_imagemagick.html">Make slideshow GIF from a batch of images using ImageMagick</a></h1>
<ol class="arabic">
<li><p class="first">Download and install ImageMagick Mac OS X Binary Release at ImageMagick official site.</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ tar xvfz ImageMagick-x86_64-apple-darwin12.4.0.tar.gz</span>
<span class="go">$ export MAGICK_HOME="/YOUR/PATH/TO/ImageMagick-6.8.6"</span>
<span class="go">$ export PATH="$MAGICK_HOME/bin:$PATH"</span>
<span class="go">$ export DYLD_LIBRARY_PATH="$MAGICK_HOME/lib/"</span>
</pre></div>
</div>
<p>See this for installation on Linux.</p>
</li>
<li><p class="first">Enter the directory where original images are stored (assuming all files are in .jpg format), use the following command:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ convert -delay 100 -loop 0 -resize 300x225 -quality 90 *.jpg image.gif</span>
</pre></div>
</div>
<p><span class="docutils literal"><span class="pre">-deplay</span></span> represents interval between slides, <span class="docutils literal"><span class="pre">-loop</span></span> indicates number of loops for slide show (0 for infinite loops); other options are intuitive. Note that *.jpg will expand to images ordered alphabetically by filename. Use the following command to re-order the images by last modified time:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ convert -delay 100 -loop 0 -resize 300x225 -quality 90 `ls -t *.jpg` image.gif</span>
</pre></div>
</div>
</li>
</ol>

        <div class="postmeta">
        <div class="author">
            <span>Posted by Shichao An</span>
        </div>
        
        <div class="tags">
            <span>
                Tags:
                <a href="tags/bash.html">Bash</a></span>
        </div>
        <div class="comments">
            <a href="http://blog.shichao-an.info/blog/html/2013/08/05/make_slideshow_gif_using_imagemagick.html#disqus_thread" data-disqus-identifier="2013/08/05/make_slideshow_gif_using_imagemagick">Leave a comment</a>
        </div></div><div class="separator post_separator"></div><div class="timestamp postmeta">
            <span>July 20, 2013</span>
        </div>
        <h1><a href="2013/07/20/configure_vsftpd_ftp_server_in_active_mode_on_centos.html">Configure vsftpd FTP server in active mode on CentOS</a></h1>
<ol class="arabic">
<li><p class="first">Install vsftpd, configure SELinux context and start the service:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># yum install vsftpd</span>
<span class="go"># chkconfig vsftpd on</span>
<span class="go"># chcon -R -t public_content_t /var/ftp</span>
<span class="go"># service vsftpd start</span>
</pre></div>
</div>
</li>
<li><p class="first">There are two ways to configure iptables to allow connections</p>
<p>One way is using system-config-firewall, which is simple:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># system-config-firewall-tui</span>
</pre></div>
</div>
<p>Choose FTP in the “Trusted Service” menu and save the configuration. <span class="docutils literal"><span class="pre">system-config-firewall</span></span> will add rule in the INPUT chain and load ip_conntrack_ftp kernel module, which can be verified using:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># lsmod | grep ftp</span>
<span class="go">nf_conntrack_ftp       10475  0</span>
<span class="go">nf_conntrack           65428  4 nf_conntrack_ftp,nf_conntrack_ipv6,nf_conntrack_ipv4,xt_state</span>
</pre></div>
</div>
<p>Another way is do it manually:</p>
<ol class="arabic">
<li><p class="first">Insert the following rule somewhere before the final “reject-with icmp-host-prohibited” rule, say number 4:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># iptables -L --line-numbers</span>
<span class="go"># iptables -I INPUT 4 -p tcp --dport 21 -m state --state NEW -j ACCEPT</span>
</pre></div>
</div>
</li>
<li><p class="first">Load ip_conntrack_ftp (alias of nf_conntrack_ftp):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># modprobe ip_conntrack_ftp</span>
</pre></div>
</div>
<p>Now the FTP directory should be accessible from remote machines.</p>
</li>
</ol>
</li>
</ol>

        <div class="postmeta">
        <div class="author">
            <span>Posted by Shichao An</span>
        </div>
        
        <div class="tags">
            <span>
                Tags:
                <a href="tags/centos.html">CentOS</a>, <a href="tags/linux.html">Linux</a>, <a href="tags/iptables.html">iptables</a></span>
        </div>
        <div class="comments">
            <a href="http://blog.shichao-an.info/blog/html/2013/07/20/configure_vsftpd_ftp_server_in_active_mode_on_centos.html#disqus_thread" data-disqus-identifier="2013/07/20/configure_vsftpd_ftp_server_in_active_mode_on_centos">Leave a comment</a>
        </div></div><div class="separator post_separator"></div><div class="timestamp postmeta">
            <span>July 13, 2013</span>
        </div>
        <h1><a href="2013/07/13/evaluation_criteria_of_computer_science_professional.html">Evaluation criteria of computer science professionals</a></h1>
<p>Personal point of view on how to evaluate the generic skills possessed by a computer software professional from a pragmatic perspective without considering specific subdisciplines or academic background in computer science.</p>
<ul class="simple">
<li>Programming Language<ul>
<li>Low-level: C/C++</li>
<li>Object-Oriented: Java/C++/PHP/Python/Ruby</li>
<li>Functional/Scripting: Lisp/Python/Perl/Haskell/Erlang</li>
<li>Web/Mobile: HTML/CSS/JavaScript</li>
</ul>
</li>
<li>System and Network<ul>
<li>System Administration (Unix)</li>
<li>OS/Kernel concept: Process, Memory, I/O</li>
<li>TCP/IP</li>
<li>Basic Scripting: bash/ksh/tcsh/zsh/Perl/Python</li>
</ul>
</li>
<li>Quantitative<ul>
<li>(Discrete) Math</li>
<li>Data Structures and Algorithms</li>
</ul>
</li>
<li>Software/Architecture/Engineering<ul>
<li>Design Pattern</li>
<li>Paradigm: Object-Oriented, Imperative</li>
<li>Purpose:</li>
<li>Low-level: kernel/driver/system/network</li>
<li>Architecture: HPC/HA/Cloud/Cluster/Distributed/Grid</li>
<li>Internet: Web/Mobile</li>
<li>Others: Architecture, Testing, SCM (SVN/Git)</li>
</ul>
</li>
<li>Database<ul>
<li>SQL/NoSQL/Cache</li>
<li>DBMS: MySQL/PostgreSQL/Oracle/MongoDB/…</li>
</ul>
</li>
<li>Conceptions<ul>
<li>Computer Architecture and Hardware</li>
</ul>
</li>
</ul>

        <div class="postmeta">
        <div class="author">
            <span>Posted by Shichao An</span>
        </div>
        
        <div class="tags">
            <span>
                Tags:
                <a href="tags/computer_science.html">Computer Science</a></span>
        </div>
        <div class="comments">
            <a href="http://blog.shichao-an.info/blog/html/2013/07/13/evaluation_criteria_of_computer_science_professional.html#disqus_thread" data-disqus-identifier="2013/07/13/evaluation_criteria_of_computer_science_professional">Leave a comment</a>
        </div></div><div class="separator post_separator"></div><div class="timestamp postmeta">
            <span>July 11, 2013</span>
        </div>
        <h1><a href="2013/07/11/get_inode_birth_time_os_x_and_bsd.html">Get the inode birth time (crtime or btime) of a file on Mac OS X and BSD descendants</a></h1>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ stat -f "%SB %N" filename.txt</span>
<span class="go">Jul 11 22:27:33 2013 filename.txt</span>
</pre></div>
</div>
<p>According to the man page, <span class="docutils literal"><span class="pre">-f</span></span> is used to display information using the specified format. <span class="docutils literal"><span class="pre">S</span></span> is an optional output format specifier that represents a string output, and <span class="docutils literal"><span class="pre">B</span></span> is a required field specifier that represent the birth time of the inode. <span class="docutils literal"><span class="pre">N</span></span> represents the file name.</p>

        <div class="postmeta">
        <div class="author">
            <span>Posted by Shichao An</span>
        </div>
        
        <div class="tags">
            <span>
                Tags:
                <a href="tags/os_x.html">OS X</a>, <a href="tags/bsd.html">BSD</a></span>
        </div>
        <div class="comments">
            <a href="http://blog.shichao-an.info/blog/html/2013/07/11/get_inode_birth_time_os_x_and_bsd.html#disqus_thread" data-disqus-identifier="2013/07/11/get_inode_birth_time_os_x_and_bsd">Leave a comment</a>
        </div></div><div class="archive_link">
        <a href="archive.html"> &mdash; Blog Archive &mdash; </a>
    </div><ul class="related clearfix">
            <li class="left"> &laquo; <a href="index.html">Newer</a></li>
            <li class="right"></li>
        </ul></article><aside class="sidebar"><section><div class="widget">
    <h1>Recent Posts</h1>
    <ul><li>
            <a href="2014/05/02/fixing_mongodb_against_unclean_shutdown.html">Fixing MongoDB against unclean shutdown</a>
        </li><li>
            <a href="2014/05/01/get_number_of_bits_of_a_python_integer.html">Get number of bits of a Python integer</a>
        </li><li>
            <a href="2014/04/09/using_bash_arrays_and_ifs_to_manipulate_filenames.html">Using Bash arrays and IFS to manipulate filenames</a>
        </li><li>
            <a href="2014/04/04/bash_double_bracket_test_contructs_and_word_splitting.html">Bash double brackets, test contructs and word splitting</a>
        </li><li>
            <a href="2014/03/20/enabling_adobe_flash_player_plugin_for_google_chrome_on_fedora.html">Enabling Adobe Flash Player plugin for Google Chrome on Fedora</a>
        </li><li>
            <a href="2014/03/17/setuid_and_uid_euid_and_suid.html">setuid() and uid, euid and suid</a>
        </li><li>
            <a href="2014/03/05/suppressing_fedora.html">Suppressing Fedora NetworkManager's prompt to connect to WPA Enterprise wireless networks</a>
        </li><li>
            <a href="2014/01/16/artistic_style_vim.html">Use Artistic Style with vim</a>
        </li><li>
            <a href="2013/11/17/sync_sleep_wakeup_ethernet_lan.html">Synchronize sleep and wakeup of machines on Ethernet LAN from Mac using SleepWatcher</a>
        </li><li>
            <a href="2013/11/10/wake_suspend_machines_local_ethernet.html">Wake and suspend machines on local Ethernet LAN</a>
        </li></ul>
</div>
</section><section><div class="widget" id="searchbox" role="search">
    <h1>Search</h1>
    <form action="search.html" method="get">
        <input type="text" name="q" />
        <button type="submit"><span class="fa fa-search"></span></button>
    </form>
</div></section><section><div class="widget">
    <h1>Tags Cloud</h1>
      <a href="tags/apache.html" style="font-size: 8pt">Apache</a>&nbsp;&nbsp;
      <a href="tags/aws.html" style="font-size: 8pt">AWS</a>&nbsp;&nbsp;
      <a href="tags/bash.html" style="font-size: 18pt">Bash</a>&nbsp;&nbsp;
      <a href="tags/bsd.html" style="font-size: 8pt">BSD</a>&nbsp;&nbsp;
      <a href="tags/centos.html" style="font-size: 10pt">CentOS</a>&nbsp;&nbsp;
      <a href="tags/computer_science.html" style="font-size: 8pt">Computer Science</a>&nbsp;&nbsp;
      <a href="tags/dns.html" style="font-size: 10pt">DNS</a>&nbsp;&nbsp;
      <a href="tags/fedora.html" style="font-size: 10pt">Fedora</a>&nbsp;&nbsp;
      <a href="tags/gdb.html" style="font-size: 8pt">GDB</a>&nbsp;&nbsp;
      <a href="tags/iptables.html" style="font-size: 8pt">iptables</a>&nbsp;&nbsp;
      <a href="tags/linux.html" style="font-size: 20pt">Linux</a>&nbsp;&nbsp;
      <a href="tags/mongodb.html" style="font-size: 8pt">MongoDB</a>&nbsp;&nbsp;
      <a href="tags/network.html" style="font-size: 12pt">Network</a>&nbsp;&nbsp;
      <a href="tags/os_x.html" style="font-size: 14pt">OS X</a>&nbsp;&nbsp;
      <a href="tags/perl.html" style="font-size: 8pt">Perl</a>&nbsp;&nbsp;
      <a href="tags/python.html" style="font-size: 12pt">Python</a>&nbsp;&nbsp;
      <a href="tags/ubuntu.html" style="font-size: 8pt">Ubuntu</a>&nbsp;&nbsp;
      <a href="tags/vim.html" style="font-size: 8pt">Vim</a>
</div></section></aside></div> <!-- #main --></div> <!-- #main-container -->

        <div class="footer-container" role="contentinfo"><footer class="wrapper">&copy; Copyright 2014, Shichao An. Powered by <a href="http://www.tinkerer.me/">Tinkerer</a> and <a href="http://sphinx.pocoo.org/">Sphinx</a>.</footer></div> <!-- footer-container -->

      </div> <!--! end of #container --><script type="text/javascript">    var disqus_shortname = "shichaosblog";    disqus_count();</script><!--[if lt IE 7 ]>
          <script src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script>
          <script>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script>
        <![endif]-->
    </body>
</html>